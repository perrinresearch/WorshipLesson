<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <title>Mass Helper</title>
  </head>
  <body>

<nav class="navbar navbar-dark" style="background-color: #00BCD4;">
  <span class="navbar-brand mb-0 h1">Chloe's Mass Helper</span>
</nav>

<div id="OuterContainer" class="mb-3 mt-3">
</div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
   <!--script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script-->
     <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script type="text/javascript">
    function toggleInfo(offDiv,onDiv) {
        document.getElementById(offDiv).style.display='None';
        document.getElementById(onDiv).style.display='inline-block';
    }


    function playMusic(el,soundfile) {
        var embed = document.getElementById("embed");
        if (!embed) {
            var embed = document.createElement("embed");
                embed.id= "embed";
                embed.setAttribute("src", soundfile);
                embed.setAttribute("hidden", "true");
            el.appendChild(embed);
        } else {
            embed.parentNode.removeChild(embed);
        }
        el.getElementsByClassName("playIcon")[0].style.display='inline-block';
    }

    function loadData(){
        //let url = "http://files.perrinresearch.com/mass.json";
        var url = "mass.json";
        console.log(url);
        $.getJSON( url, function( data ) {
            console.log('Anything?');
            console.log(data);
            var items = [];
            $.each( data, function( key, val ) {
                items.push( "<li id='" + key + "'>" + val + "</li>" );
            });
           
            $( "<ul/>", {
                "class": "my-new-list",
                html: items.join( "" )
            }).appendTo( "body" );
        });
        console.log('Done');
    }

    //loadData();

    jsonData = {
        "title":"Chloe's Mass Helper",
        "sections":[{
            "color":"#CDDC39",
            "image":"img/IntroductoryRites.png",
            "title":"1. Introductory Rites",
            "row":[{
                 "name": "Entrance Song",
                 "actionLabel":"Hymn",
                 "actionIcon":"img/music_icon.svg",
                 "stanceLabel":"STAND",
                 "stanceIcon":"img/stand_icon.svg",
               },{
                 "name": "Greeting",
                 "actionLabel":"",
                 "actionIcon":"",
                 "stanceLabel":"STAND",
                 "stanceIcon":"img/stand_icon.svg",
               },{
                 "name": "Act of Penitence",
                 "actionLabel":"",
                 "actionIcon":"",
                 "stanceLabel":"STAND",
                 "stanceIcon":"img/stand_icon.svg",
               },{
                 "name": "Gloria",
                 "actionLabel":"Gloria",
                 "actionIcon":"img/music_icon.svg",
                 "stanceLabel":"STAND",
                 "stanceIcon":"img/stand_icon.svg",
               },{
                 "name": "Opening Prayer",
                 "actionLabel":"",
                 "actionIcon":"",
                 "stanceLabel":"STAND",
                 "stanceIcon":"img/stand_icon.svg",
               }]
        },{
            "color":"#FFC107",
            "image":"img/LiturgyOfTheWord.png",
            "title":"2. Liturgy of the Word",
            "row":[{
                 "name": "First Reading",
                 "actionLabel":"Reading",
                 "actionIcon":"",
                 "stanceLabel":"SIT",
                 "stanceIcon":"img/sit_icon2.png",
               },{
                 "name": "Responsal Psalm",
                 "actionUrl":"music/current/Gloria.mp3",
                 "actionLabel":"Hymn",
                 "actionIcon":"img/music_icon.svg",
                 "stanceLabel":"SIT",
                 "stanceIcon":"img/sit_icon2.png",
               },{
                 "name": "Second Reading",
                 "actionLabel":"Reading",
                 "actionIcon":"",
                 "stanceLabel":"SIT",
                 "stanceIcon":"img/sit_icon2.png",
               },{
                 "name": "Gospel Acclamation",
                 "actionUrl":"music/current/Acclamation.mp3",
                 "actionLabel":"Acclamation",
                 "actionIcon":"img/music_icon.svg",
                 "stanceLabel":"STAND",
                 "stanceIcon":"img/stand_icon.svg",
               },{
                 "name": "Gospel",
                 "actionLabel":"Reading",
                 "actionIcon":"",
                 "stanceLabel":"STAND",
                 "stanceIcon":"img/stand_icon.svg",
               },{
                 "name": "Homily",
                 "actionLabel":"",
                 "actionIcon":"",
                 "stanceLabel":"SIT",
                 "stanceIcon":"img/sit_icon2.png",
               }]
        },{
            "color":"#00BCD4",
            "image":"img/LiturgyOfTheEucharist.png",
            "title":"3. Liturgy of the Eucharist",
            "row":[{
                 "name": "Lord's Prayer",
                 "actionUrl":"music/current/Gloria.mp3",
                 "actionLabel":"Prayer",
                 "actionIcon":"img/music_icon.svg",
                 "stanceLabel":"STAND",
                 "stanceIcon":"img/stand_icon.svg",
               },{
                 "name": "Sign of Peace",
                 "actionLabel":"Peace",
                 "actionIcon":"",
                 "stanceLabel":"STAND",
                 "stanceIcon":"img/stand_icon.svg",
               },{
                 "name": "Lamb of God",
                 "actionLabel":"Prayer",
                 "actionIcon":"",
                 "stanceLabel":"STAND",
                 "stanceIcon":"img/stand_icon.svg",
               },{
                 "name": "Communion",
                 "actionUrl":"music/current/Gloria.mp3",
                 "actionLabel":"Hymn",
                 "actionIcon":"img/music_icon.svg",
                 "stanceLabel":"KNEEl",
                 "stanceIcon":"img/kneel_icon.png",
               },{
                 "name": "Prayer",
                 "actionLabel":"",
                 "actionIcon":"",
                 "stanceLabel":"KNEEL",
                 "stanceIcon":"img/kneel_icon.png",
               }]
        },{
            "color":"#E91E63",
            "image":"img/ConcludingRite.png",
            "title":"4. Concluding Rite",
            "row":[{
                 "name": "Greeting and Blessing",
                 "actionUrl":"music/current/Gloria.mp3",
                 "actionLabel":"Hymn",
                 "actionIcon":"img/music_icon.svg",
                 "stanceLabel":"STAND",
                 "stanceIcon":"img/stand_icon.svg",
               },{
                 "name": "Announcements",
                 "actionLabel":"",
                 "actionIcon":"",
                 "stanceLabel":"SIT",
                 "stanceIcon":"img/sit_icon2.png",
               },{
                 "name": "Dismissal of Assembly",
                 "actionLabel":"Sign of the Cross",
                 "actionIcon":"",
                 "stanceLabel":"STAND",
                 "stanceIcon":"img/stand_icon.svg",
               },{
                 "name": "Recession Song",
                 "actionUrl":"music/current/Gloria.mp3",
                 "actionLabel":"Hymn",
                 "actionIcon":"img/music_icon.svg",
                 "stanceLabel":"STAND",
                 "stanceIcon":"img/stand_icon.svg",
               }]
        }]
    }

    console.log(jsonData);

    function makeContainer(sectionData,sectionId){
        let secA = sectionId + "A";
        let secB = sectionId + "B";

        var box = document.createElement("div");
        box.className = "container pr-0 pl-0 mb-3 mt-3";
        box.style = "background-color:" + sectionData["color"] + ";"

        var media = document.createElement("div");
        media.className = "media";
        var mediaImg = document.createElement("img");
        mediaImg.className = "align-self-center";
        mediaImg.src = sectionData["image"];
        mediaImg.alt = "Generic placeholder image"
        media.appendChild(mediaImg);

        var info1 = document.createElement("div");
        info1.id = secA;
        info1.className = "media-body";
        info1.style = "height:235px;width:100%;line-height:235px;text-align:center;display:inline-block";
        info1.onclick = function() {toggleInfo(secA,secB) };
        var info1child = document.createElement("h1");
        if (sectionData["color"] === "#E91E63" ){
            info1child.style = "display: inline-block;vertical-align: middle;line-height: normal;color:#ffffff;";
        } else {
            info1child.style = "display: inline-block;vertical-align: middle;line-height: normal;";
        }
        var newContent1 = document.createTextNode(sectionData["title"]); 
        info1child.appendChild(newContent1);  
        info1.appendChild(info1child);

        var info2 = document.createElement("div");
        info2.id = secB;
        info2.className = "media-body";
        info2.style = "height:235px;width:100%;display:none;";
        var info2header = document.createElement("div");
        info2header.className = "media-body";
        info2header.style = "height:50px;line-height:50px;display: inline-block;";
        info2header.onclick = function() {toggleInfo(secB,secA)};
        var info2child = document.createElement("h4");
        info2child.className = "mt-0 pl-4";
        if (sectionData["color"] === "#E91E63" ){
            info2child.style = "display: inline-block;vertical-align: middle;line-height: normal;color:#ffffff;";
        } else {
            info2child.style = "display: inline-block;vertical-align: middle;line-height: normal;";
        }
        var newContent2 = document.createTextNode(sectionData["title"]);
        info2child.appendChild(newContent2);
        info2header.appendChild(info2child);
        info2.appendChild(info2header);

        var info2table = document.createElement("table");
        info2table.style = "height:180px;width:100%;font-size:20px;";
        let odd = true;
        for(let row of sectionData["row"]){
            var tr = document.createElement("tr");
            if (odd){
                tr.style = "background-color:rgba(255, 255, 255, 0.6);";
                odd = false;
            } else {
                tr.style = "background-color:rgba(255, 255, 255, 0.4);";
                odd = true;
            }
            // 1st column: Check box and Label
            var td = document.createElement("td");
            td.className = "pl-3";
            var tddiv = document.createElement("div");
            tddiv.className = "checkbox";
            tddiv.style = "width:16px;height:16px;border:1px solid black;margin-top:3px;margin-top:3px;margin-right:3px;display: inline-block";
            td.appendChild(tddiv);
            var label = document.createTextNode(row["name"]);
            td.appendChild(label);
            tr.appendChild(td);

            // 2nd column: Action
            var td = document.createElement("td");
            var div = document.createElement("div");
            if(row["actionUrl"]){
                console.log(row["actionUrl"]);
                div.onclick = function() {playMusic(this,row["actionUrl"])};
            }
            var img = document.createElement("img");
            img.src = row["actionIcon"];
            img.style = "height:24px"
            div.appendChild(img);
            var label = document.createTextNode(row["actionLabel"]);
            div.appendChild(label);
            var img = document.createElement("img");
            img.className = "playIcon";
            img.src = "img/play_icon.svg";
            img.style = "height:24px;display:None;";
            div.appendChild(img);
            td.appendChild(div);
            tr.appendChild(td);

            // 3rd column: Stand/Sit/Kneel
            var td = document.createElement("td");
            var img = document.createElement("img");
            img.src = row["stanceIcon"];
            img.style = "height:24px";
            td.appendChild(img);
            var label = document.createTextNode(row["stanceLabel"]);
            td.appendChild(label);
            tr.appendChild(td);

            info2table.appendChild(tr); 
        }
        var info2tablediv = document.createElement("div");
        info2tablediv.appendChild(info2table);
        info2.appendChild(info2tablediv);

        media.appendChild(info1);
        media.appendChild(info2);
        box.appendChild(media);
        document.getElementById('OuterContainer').appendChild(box);        
    }

    let test = 'test';
    let i = 0;
    for(let data of jsonData['sections']){
        makeContainer(data,test + i);
        i = i + 1;
    }

</script>
  </body>
</html>
